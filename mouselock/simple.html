<html>
<head>
<title>Simple Mouse Lock Demo</title>
<style>
#div {
  background: #CCFFFF;
  width: 500px;
  height: 500px;
}
</style>
<script>
function fullAndLock() {
  var div = document.getElementById('div');

  document.addEventListener('mozfullscreenchange', function() {
    var pointer = navigator.mozPointer;

    if (document.mozFullScreen &&
        document.mozFullScreenElement === div &&
        !pointer.isLocked()) {
      function moveHandler(e) {
        div.innerHTML = "Mouse Locked: movementX=" + e.mozMovementX + ", movementY=" + e.mozMovementY;
      }

      pointer.lock(
        div,
        function() {
          document.addEventListener('mouselocklost', function() {
            div.removeEventListener('mousemove', moveHandler, false);
            div.innerHTML = "Mouse Lock Lost"
          }, false);

          div.addEventListener('mousemove', moveHandler, false);
        },
        function() {
          div.innerHTML = "Mouse Lock Failed";
        }
      );
    }
  }, false);

  div.mozRequestFullScreen();
}
</script>
</head>
<body>
<p>Click the button to go into fullscreen and lock the mouse.  The 'div' div will become the fullscreen, mouse locked element.</p>
<div><button onclick="fullAndLock();">Mouse Lock</button></div>
<div id="div">Mouse is not locked</div>
</body>
</html>
